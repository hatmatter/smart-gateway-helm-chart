SignalFx Smart Gateway Helm Chart
=================================

A Helm chart for deploying the SignalFx Smart Gateway on kubernetes.

See [./helm/signalfx-smart-gateway][README.md] information about the chart and
its configurations.

## Developers
### CircleCi Tests

#### Helm Lint

We run `helm lint` against the helm chart while passing [helm/dev-values.yaml]

```bash
$ helm lint ./helm/signalfx-smart-gateway --values ./helm/dev-values.yaml
```

#### yamllint

We use [yamllint] to lint the yaml generated by the helm chart.

To generate the yaml from the helm chart, run `helm template` and pass in 
[helm/dev-values.yaml].

```bash
$ helm template ./helm/signalfx-smart-gateway --values ./helm/dev-values.yaml
```

Please refer to the environment variable `YAML_LINT_VERSION` to find the version
of [yamllint] this project is using.

On CircleCI the generated yaml is saved as a job artifact.

To lint the generated yaml, run `yamllint` against the generated yaml with the
`yamllint` configurations defined in [./yaml-lint-config.yaml].

```bash
$ yamllint -c ./yaml-lint-config.yaml generated-helm-template.yaml
```

#### README.md Generation

The [README.md][README.md] for the helm chart is generated
from [README.md.gotmpl] with [github.com/norwoodj/helm-docs].

On CircleCi the [README.md] will be regenerated and compared to the committed
[README.md].  If there are differences the job will fail.  You should regenerate
the [README.md] using the version of [github.com/norwoodj/helm-docs] specified
in [./circleci/config.yml] with the environment variable `HELM_DOCS_VERSION`.

[README.md]: ./helm/signalfx-smart-gateway/README.md
[README.md.gotmpl]: ./helm/signalfx-smart-gateway/README.md.gotmpl
[./circleci/config.yml]: ./.circleci/config.yml
[./helm/dev-values.yaml]: ./helm/dev-values.yaml
[github.com/norwoodj/helm-docs]: https://github.com/norwoodj/helm-docs
[yamllint]: https://pypi.org/project/yamllint/
